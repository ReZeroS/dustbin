# TinyData
A tiny database implemented with c++11 & c.


（感觉自己傻得一逼）

```
数据库课程设计评分标准
（除第8项任务外，每项任务1分，总共15分；
4分及格，5分中，6-7分良，8分及以上优）
```

1. 设计数据库系统的系统表，用于存储数据库表、视图、索引等数据库对象的信息；{数据表占0.5分，视图和索引占0.5分，要有存储文件对应}

2. 设计数据库系统的普通表（数据文件），用于存储数据表的数据；{一个数据文件只存放一个数据表的数据得0.5分，一个数据文件可以存放多个数据表的数据得1分}

3. 利用B+树索引设计索引文件，用于存储数据表的索引数据；{要有存储文件对应}

4. 设计用户表和权限表，分别用于存储所有用户的信息和每个用户访问权限的信息；{用户数据结构占0.5分，用户包含超级管理员和普通用户；权限数据结构占0.5分，存储每个用户对每一个数据库对象的访问权限；要有存储文件对应}

5. 输入“help database”命令，输出所有数据表、视图和索引的信息，同时显示其对象类型；输入“help table 表名”命令，输出数据表中所有属性的详细信息，包括属性名称、数据类型、约束条件等；输入“help view 视图名”命令，输出视图的定义语句；输入“help index 索引名”命令，输出索引的详细信息；{4个各占0.25分，不要输出数据表中的数据}

6. 解析CREATE、SELECT、INSERT、DELETE、UPDATE等SQL语句，检查SQL语句中的语法错误和语义错误，并指出错误原因；{5个语句各占0.2分}

7. 执行CREATE语句，创建数据表、视图、索引三种数据库对象；创建数据表时需要包含主码、外码、唯一性约束、非空约束等完整性约束的定义；{创建数据表占0.5分，创建视图占0.3分，创建索引占0.2分；create table要支持主码、外码、unique 和 not null、check约束，约束缺失扣除0.2分}

8. 执行SELECT语句，从自主设计的数据表中查询数据，并输出结果；在SELECT语句中需要支持GROUP BY、HAVING和ORDER BY子句，需要支持5种聚集函数；{单表查询占0.4分、连接查询占0.4分、嵌套查询占0.8分、集合查询占0.4分；where语句支持and、or、between and、in、like等谓词，简单的单表查询功能仅得0.2分}

9. 执行INSERT、DELETE和UPDATE语句，更新数据表的内容；更新过程中需要检查更新后的数据表是否会违反参照完整性约束。如果是，则提示违反哪一条完整性约束，并拒绝执行更新操作；如果否，提示数据表更新成功，并说明插入、删除或修改了几个元组。{insert语句占0.4分，update语句占0.4分，delete语句占0.2分，insert要实现单个元组的插入和元组集合的插入（带子查询），要检查实体完整性（唯一和非空），参照完整性约束和check约束，约束缺失扣除0.2分。 delete和update要支持where子句（and、or、between and、in、like），条件缺失扣除0.2分}

10. 当数据表的内容更新后，根据索引的定义，自动更新索引表的内容；
{有存储索引节点的数据结构，有构造B+树的函数}

11. 在有索引的数据表上执行查询语句时，首先利用索引找到满足条件的元组指针，然后通过指针到数据表中取出相应的元组；

12. 执行GRANT语句，为用户授予对某数据库对象的SELECT、INSERT、DELETE、UPDATE等权限；执行REVOKE语句，收回上述权限；{grant和revoke各占0.5分}
{需要用户和权限（二维-对某数据对象的某权限）的数据结构，有存储文件对应}

13. 用户登录时，需要输入正确的用户名和密码；如果用户没有被授权，则拒绝执行用户查询或更新等操作，并给出提示信息；{有用户名和密码管理得0.5分；有权限管理得0.5分}

14. 将SELECT语句转化为关系代数表达式，再利用查询优化算法对关系代数表达式进行优化，输出优化后的关系代数表达式或SELECT语句。

